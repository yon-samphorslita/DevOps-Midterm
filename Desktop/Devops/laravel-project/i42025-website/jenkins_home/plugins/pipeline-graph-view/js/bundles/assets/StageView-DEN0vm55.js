const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ConsoleLogStream-C9Lr7KnS.js","./connections-D9dwIvBS.js"])))=>i.map(i=>d[i]);
(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('.pgv-stage-details{--bg-color: var(--color, var(--text-color-secondary));position:relative;display:grid;grid-template-columns:1fr auto;gap:.5rem;padding:.125rem calc(1rem + var(--jenkins-border-width, 2px));padding-right:.7rem;border-radius:var(--form-input-border-radius);margin-bottom:.75rem;z-index:101}.pgv-stage-details:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:oklch(from var(--bg-color) l c h/.075);border:var(--jenkins-border-width, 2px) solid oklch(from var(--bg-color) l c h/.1);border-radius:inherit;transition:var(--standard-transition);pointer-events:none}@media (prefers-contrast: more){.pgv-stage-details:before{border-color:var(--text-color)}}.pgv-stage-details>div{display:flex;align-items:center;gap:.75rem}.pgv-stage-details>div>div{display:contents}.pgv-stage-details>div svg{width:1.375rem;height:1.375rem}.pgv-stage-details h2{font-size:var(--font-size-sm);font-weight:var(--font-bold-weight);margin:0;text-box:trim-both}.pgv-stage-details .jenkins-button{--button-background--hover: oklch(from currentColor l c h / .1);--button-background--active: oklch(from currentColor l c h / .2);--button-box-shadow--focus: oklch(from currentColor l c h / .1);color:var(--color)!important;border-radius:.4rem;margin-inline:-.85rem;padding-inline:1.125rem}.pgv-stage-details .jenkins-button:before,.pgv-stage-details .jenkins-button:after{top:3px;right:7px;bottom:3px;left:7px}.pgv-stage-details ul{display:flex;gap:1.25rem;padding:0;margin:0}.pgv-stage-details ul li,.pgv-stage-details ul li span{display:flex;align-items:center;gap:1ch;text-box:trim-both}.pgv-stage-details ul li svg{width:1.125rem;height:1.125rem;flex-shrink:0}.pgv-stage-details ul li svg *{stroke-width:36px}.pgv-stage-details__running{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:inherit;background:var(--bg-color);pointer-events:none;animation:pulse 2s ease-in-out infinite;opacity:0}@keyframes pulse{50%{opacity:.1}}.pgv-step-detail-group{position:relative}.pgv-step-detail-group:hover{z-index:100}.pgv-step-detail-header{position:sticky;top:calc(var(--header-height) + .375rem);z-index:1;display:grid;grid-template-columns:1fr auto;border-radius:.375rem;cursor:pointer;width:100%;box-shadow:0 0 0 .375rem var(--card-background);background-color:var(--card-background);padding:0 0 0 .5rem!important}.pgv-step-detail-header>a:first-of-type{display:grid;grid-template-columns:1fr auto;align-items:center;justify-content:stretch;gap:1rem;text-decoration:none;color:var(--text-color);min-height:2.5rem}.pgv-step-detail-header .jenkins-button{padding:0 .6rem;color:var(--text-color-secondary)!important;margin-left:.45rem}.pgv-step-detail-header .jenkins-button:before,.pgv-step-detail-header .jenkins-button:after{display:none}.pgv-step-detail-header .jenkins-button svg{width:1rem;height:1rem}.pgv-step-detail-header .jenkins-button:hover{color:var(--text-color)!important}.pgv-step-detail-header__content{display:flex;align-items:center;font-size:var(--font-size-sm);gap:.75rem;padding-left:.15rem;overflow:hidden}.pgv-step-detail-header__content span{max-width:80%;overflow:hidden;text-overflow:ellipsis;color:var(--text-color-secondary);font-family:var(--font-family-mono)}.pgv-step-detail-header__content span:first-of-type{color:var(--text-color);font-weight:var(--font-bold-weight);font-family:var(--font-family-sans)}.pgv-step-detail-header__content .pgv-step-detail-header__chevron{transition:var(--standard-transition);width:1rem;height:1rem;margin-inline:-.25rem;flex-shrink:0}.pgv-step-detail-header__content>svg:first-of-type{width:1.375rem;height:1.375rem}.pgv-step-detail-header__actions{display:flex;align-items:center;gap:.65rem}.pgv-step-detail-header__actions>button{min-width:38px;padding-inline:0!important}.pgv-show-more-logs{position:sticky;top:calc(var(--header-height) + .375rem + .375rem + 2.375rem);background:var(--card-background);box-shadow:0 0 .375rem var(--card-background);z-index:10;border-radius:.375rem;width:100%}.console-text div{text-indent:0;display:inline-block}pre.console-output-line{text-align:left;padding:0;margin:0;border-radius:0}a.console-line-number{text-align:right;margin-right:14px;color:var(--text-color-secondary);white-space:nowrap;display:inline-block;flex-shrink:0;-webkit-user-select:none;user-select:none}div.console-output-line-anchor{position:relative;top:-50px;visibility:hidden}div.console-output-line{position:relative;display:flex;padding-block:2px}div.console-output-line:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background-color:color-mix(in srgb,var(--text-color-secondary) 5%,transparent);border:var(--jenkins-border-width, 2px) solid color-mix(in srgb,var(--text-color-secondary) 2.5%,transparent);border-radius:.375rem;opacity:0;transition:opacity var(--standard-transition);pointer-events:none}div.console-output-line:hover:before{opacity:1}.pgv-stage-steps{display:flex;flex-direction:column;gap:.375rem;border:var(--jenkins-border, 2px solid color-mix(in srgb, var(--text-color-secondary) 10%, transparent));background:var(--card-background);border-radius:var(--form-input-border-radius);padding:.375rem;margin-bottom:calc(var(--section-padding) * -1)}.pgv-scroll-to-top-bottom__container{position:sticky;bottom:0;z-index:999;margin-top:-.375rem}.pgv-scroll-to-top-bottom{position:absolute;top:calc((3.125rem + var(--section-padding)) * -1);right:calc(var(--section-padding) / 2);display:flex;gap:.375rem;padding:.375rem;border-radius:100px;box-shadow:var(--dropdown-box-shadow);background:color-mix(in sRGB,var(--card-background) 85%,transparent);-webkit-backdrop-filter:var(--dropdown-backdrop-filter);backdrop-filter:var(--dropdown-backdrop-filter);opacity:0;scale:.25;transition:var(--elastic-transition);pointer-events:none}.pgv-scroll-to-top-bottom--visible{opacity:1;scale:1;pointer-events:auto}@media (prefers-reduced-motion: reduce){.pgv-scroll-to-top-bottom{transition:none}}.pgv-scroll-to-top-bottom .jenkins-button{padding:0;width:2.375rem;border-radius:100px}.pgv-scroll-to-top-bottom .jenkins-button svg{transition:translate .1s ease-in-out}.pgv-scroll-to-top-bottom .jenkins-button:not(:disabled):first-of-type:hover svg{translate:0 -1px}.pgv-scroll-to-top-bottom .jenkins-button:not(:disabled):last-of-type:hover svg{translate:0 1px}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{j as e,r as a,H as b}from"./connections-D9dwIvBS.js";import{S as g,T as k,a as m,e as C,b as L,P as M,r as B}from"./timings-D3e1D_MJ.js";import{a as S,c as v}from"./dropdown-CLdj346s.js";import{_ as y}from"../pipeline-console-view-bundle.js";import{L as w}from"./PipelineConsole-BOAihGx0.js";import"./tree-api-16e_7KIy.js";function T({agent:t}){if(!t)return null;const i=t=="built-in"?"Jenkins":t,o=l(t);function l(s){const n=s=="built-in"?"(built-in)":s;return`${document.head.dataset.rooturl}/computer/${n}/`}return e.jsx("li",{children:e.jsxs("a",{href:o,className:"jenkins-button jenkins-button--tertiary",target:"_blank",children:[e.jsx("svg",{width:"512px",height:"512px",viewBox:"0 0 512 512",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinejoin:"round",children:e.jsxs("g",{transform:"translate(32.000000, 64.000000)",stroke:"currentColor",strokeWidth:"32",children:[e.jsx("rect",{x:"0",y:"0",width:"448",height:"320",rx:"32"}),e.jsx("polygon",{strokeLinecap:"round",fillRule:"nonzero",points:"272 384 264 320 184 320 176 384"}),e.jsx("line",{x1:"336",y1:"384",x2:"112",y2:"384",strokeLinecap:"round"})]})})}),i]})})}function _({stage:t}){return t?e.jsxs("div",{className:"pgv-stage-details "+B(t.state,t.skeleton),children:[t.state==="running"&&e.jsx("div",{className:"pgv-stage-details__running"}),e.jsxs("div",{children:[e.jsx(g,{status:t.state,skeleton:t.skeleton,percentage:t.completePercent}),e.jsx("h2",{children:t.name})]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M112.91 128A191.85 191.85 0 0064 254c-1.18 106.35 85.65 193.8 192 194 106.2.2 192-85.83 192-192 0-104.54-83.55-189.61-187.5-192a4.36 4.36 0 00-4.5 4.37V152",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M233.38 278.63l-79-113a8.13 8.13 0 0111.32-11.32l113 79a32.5 32.5 0 01-37.25 53.26 33.21 33.21 0 01-8.07-7.94z",fill:"currentColor"})]}),e.jsx(k,{ms:t.totalDurationMillis})]}),e.jsx("li",{children:e.jsx(m,{content:C(t.startTimeMillis),children:e.jsxs("span",{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M256 64C150 64 64 150 64 256s86 192 192 192 192-86 192-192S362 64 256 64z",fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 128v144h96"})]}),e.jsx(L,{since:t.startTimeMillis})]})})}),t.pauseDurationMillis!==0&&e.jsxs("li",{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M145.61 464h220.78c19.8 0 35.55-16.29 33.42-35.06C386.06 308 304 310 304 256s83.11-51 95.8-172.94c2-18.78-13.61-35.06-33.41-35.06H145.61c-19.8 0-35.37 16.28-33.41 35.06C124.89 205 208 201 208 256s-82.06 52-95.8 172.94c-2.14 18.77 13.61 35.06 33.41 35.06z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M343.3 432H169.13c-15.6 0-20-18-9.06-29.16C186.55 376 240 356.78 240 326V224c0-19.85-38-35-61.51-67.2-3.88-5.31-3.49-12.8 6.37-12.8h142.73c8.41 0 10.23 7.43 6.4 12.75C310.82 189 272 204.05 272 224v102c0 30.53 55.71 47 80.4 76.87 9.95 12.04 6.47 29.13-9.1 29.13z",fill:"currentColor"})]}),e.jsx(M,{since:t.pauseDurationMillis})]}),e.jsx(T,{agent:t.agent}),e.jsx("li",{children:e.jsx(S,{disabled:t.synthetic,items:[{text:"View stage as plain text",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M416 221.25V416a48 48 0 01-48 48H144a48 48 0 01-48-48V96a48 48 0 0148-48h98.75a32 32 0 0122.62 9.37l141.26 141.26a32 32 0 019.37 22.62z",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{d:"M256 56v120a32 32 0 0032 32h120M176 288h160M176 368h160",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"})]}),href:`log?nodeId=${t.id}`,target:"_blank"},{text:"Download stage logs",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[e.jsx("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})]}),href:`log?nodeId=${t.id}`,download:`${t.name}.txt`}]})})]})]}):null}const E=b.lazy(()=>y(()=>import("./ConsoleLogStream-C9Lr7KnS.js"),__vite__mapDeps([0,1]),import.meta.url));function N(t){a.useEffect(()=>{t.isExpanded&&t.handleMoreConsoleClick(t.step.id,t.stepBuffer.startByte)},[t.isExpanded]);const i=n=>{n.button!==0||n.metaKey||n.ctrlKey||(n.preventDefault(),history.replaceState({},"","?selected-node="+t.step.id),t.handleStepToggle(t.step.id))},o=()=>{let n=t.stepBuffer.startByte-w;n<0&&(n=0),t.handleMoreConsoleClick(t.step.id,n)},l=()=>{if(t.stepBuffer.lines&&t.stepBuffer.startByte>0)return e.jsxs("button",{onClick:o,className:"pgv-show-more-logs jenkins-button jenkins-!-warning-color",children:["There’s more to see - ",s(t.stepBuffer.startByte)," ","of logs hidden"]})},s=n=>n<1024?`${n}B`:n<1048576?`${(n/1024).toFixed(2)}KiB`:n<1073741824?`${(n/1048576).toFixed(2)}MiB`:`${(n/1073741824).toFixed(2)}GiB`;return e.jsxs("div",{className:"pgv-step-detail-group",children:[e.jsxs("div",{className:v("pgv-step-detail-header","jenkins-button",{"jenkins-button--tertiary":!t.isExpanded}),children:[e.jsxs("a",{href:"?selected-node="+t.step.id,onClick:i,children:[e.jsxs("div",{className:"pgv-step-detail-header__content",children:[e.jsx(g,{status:t.step.state,percentage:t.step.completePercent}),t.step.title!==""&&e.jsx("span",{children:t.step.title}),t.step.name!==""&&e.jsx("span",{children:t.step.name}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"pgv-step-detail-header__chevron",style:{rotate:t.isExpanded?"90deg":"0deg"},children:e.jsx("path",{fill:"none",stroke:"var(--text-color-secondary)",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",opacity:.75,d:"M184 112l144 144-144 144"})})]}),e.jsx("div",{className:"pgv-step-detail-header__actions",children:e.jsx("span",{style:{color:"var(--text-color-secondary)",fontWeight:"normal"},children:e.jsx(k,{ms:t.step.totalDurationMillis})})})]},`step-action-area-${t.step.id}`),e.jsx(m,{content:"View step as plain text",children:e.jsx("a",{href:`log?nodeId=${t.step.id}`,className:"jenkins-button jenkins-button--tertiary",target:"_blank",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{d:"M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48M336 64h112v112M224 288L440 72",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"})})})})]}),t.isExpanded&&e.jsxs("div",{style:{paddingTop:"0.5rem"},children:[l(),e.jsx(a.Suspense,{children:e.jsx(E,{logBuffer:t.stepBuffer,handleMoreConsoleClick:t.handleMoreConsoleClick,step:t.step,maxHeightScale:.65})})]})]},`step-card-${t.step.id}`)}function W(){const[t,i]=a.useState(!0),[o,l]=a.useState(!1),[s,n]=a.useState(!1);a.useEffect(()=>{const d=()=>{const h=window.scrollY||document.documentElement.scrollTop,p=window.innerHeight,f=document.documentElement.scrollHeight,x=h<100,j=h+p>=f-100;i(x),l(j),n(!(x&&j))};d(),window.addEventListener("scroll",d),window.addEventListener("resize",d);const u=new MutationObserver(d);return u.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("scroll",d),window.removeEventListener("resize",d),u.disconnect()}},[]);const r=()=>{window.scrollTo({top:0})},c=()=>{window.scrollTo({top:document.body.scrollHeight})};return e.jsx("div",{className:"pgv-scroll-to-top-bottom__container",children:e.jsxs("div",{className:v("pgv-scroll-to-top-bottom",{"pgv-scroll-to-top-bottom--visible":s}),"aria-hidden":!s,children:[e.jsx("button",{onClick:r,className:"jenkins-button",disabled:t,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 244l144-144 144 144M256 120v292"})})}),e.jsx("button",{onClick:c,className:"jenkins-button",disabled:o,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M112 268l144 144 144-144M256 392V100"})})})]})})}function $({stage:t,stepBuffers:i,steps:o,handleStepToggle:l,expandedSteps:s,handleMoreConsoleClick:n}){return o.length===0?null:e.jsxs("div",{className:"pgv-stage-steps",children:[o.map(r=>e.jsx(N,{step:r,stepBuffer:i.get(r.id)??{lines:[],startByte:0-w,endByte:-1},handleStepToggle:l,isExpanded:s.includes(r.id),handleMoreConsoleClick:n},`step-console-card-${r.id}`)),e.jsx(W,{})]},`stage-steps-container-${t?t.id:"unk"}`)}function F(t){return e.jsxs(e.Fragment,{children:[e.jsx(_,{stage:t.stage}),e.jsx($,{stage:t.stage,steps:t.steps,stepBuffers:t.stepBuffers,expandedSteps:t.expandedSteps,handleStepToggle:t.handleStepToggle,handleMoreConsoleClick:t.handleMoreConsoleClick})]})}export{F as default};
//# sourceMappingURL=StageView-DEN0vm55.js.map
